\doxysection{ANN.\+h}
\hypertarget{_a_n_n_8h_source}{}\label{_a_n_n_8h_source}\index{include/ANN/ANN.h@{include/ANN/ANN.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ File:\ \ \ \ \ \ \ \ \ \ \ \ ANN.h}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Programmer:\ \ \ \ \ \ Sunil\ Arya\ and\ David\ Mount}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Description:\ \ \ \ \ Basic\ include\ file\ for\ approximate\ nearest}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ neighbor\ searching.}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Last\ modified:\ \ \ 01/27/10\ (Version\ 1.1.2)}}
\DoxyCodeLine{00007\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Copyright\ (c)\ 1997-\/2010\ University\ of\ Maryland\ and\ Sunil\ Arya\ and}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ David\ Mount.\ \ All\ Rights\ Reserved.}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ This\ software\ and\ related\ documentation\ is\ part\ of\ the\ Approximate}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ Nearest\ Neighbor\ Library\ (ANN).\ \ This\ software\ is\ provided\ under}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ the\ provisions\ of\ the\ Lesser\ GNU\ Public\ License\ (LGPL).\ \ See\ the}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ file\ ../ReadMe.txt\ for\ further\ information.}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ The\ University\ of\ Maryland\ (U.M.)\ and\ the\ authors\ make\ no}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ representations\ about\ the\ suitability\ or\ fitness\ of\ this\ software\ for}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ any\ purpose.\ \ It\ is\ provided\ "{}as\ is"{}\ without\ express\ or\ implied}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ warranty.}}
\DoxyCodeLine{00020\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ History:}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ \ Revision\ 0.1\ \ 03/04/98}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ \ \ \ \ \ Initial\ release}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ \ Revision\ 1.0\ \ 04/01/05}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ \ \ \ \ \ Added\ copyright\ and\ revision\ information}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ \ \ \ \ \ Added\ ANNcoordPrec\ for\ coordinate\ precision.}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ \ \ \ \ \ Added\ methods\ theDim,\ nPoints,\ maxPoints,\ thePoints\ to\ ANNpointSet.}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ \ \ \ \ \ Cleaned\ up\ C++\ structure\ for\ modern\ compilers}}
\DoxyCodeLine{00029\ \textcolor{comment}{//\ \ Revision\ 1.1\ \ 05/03/05}}
\DoxyCodeLine{00030\ \textcolor{comment}{//\ \ \ \ \ \ Added\ fixed-\/radius\ k-\/NN\ searching}}
\DoxyCodeLine{00031\ \textcolor{comment}{//\ \ Revision\ 1.1.2\ \ 01/27/10}}
\DoxyCodeLine{00032\ \textcolor{comment}{//\ \ \ \ \ \ Fixed\ minor\ compilation\ bugs\ for\ new\ versions\ of\ gcc}}
\DoxyCodeLine{00033\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ ANN\ -\/\ approximate\ nearest\ neighbor\ searching}}
\DoxyCodeLine{00037\ \textcolor{comment}{//\ \ ANN\ is\ a\ library\ for\ approximate\ nearest\ neighbor\ searching,}}
\DoxyCodeLine{00038\ \textcolor{comment}{//\ \ based\ on\ the\ use\ of\ standard\ and\ priority\ search\ in\ kd-\/trees}}
\DoxyCodeLine{00039\ \textcolor{comment}{//\ \ and\ balanced\ box-\/decomposition\ (bbd)\ trees.\ Here\ are\ some}}
\DoxyCodeLine{00040\ \textcolor{comment}{//\ \ references\ to\ the\ main\ algorithmic\ techniques\ used\ here:}}
\DoxyCodeLine{00041\ \textcolor{comment}{//}}
\DoxyCodeLine{00042\ \textcolor{comment}{//\ \ \ \ \ \ kd-\/trees:}}
\DoxyCodeLine{00043\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Friedman,\ Bentley,\ and\ Finkel,\ \`{}\`{}An\ algorithm\ for\ finding}}
\DoxyCodeLine{00044\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ best\ matches\ in\ logarithmic\ expected\ time,''\ ACM}}
\DoxyCodeLine{00045\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Transactions\ on\ Mathematical\ Software,\ 3(3):209-\/226,\ 1977.}}
\DoxyCodeLine{00046\ \textcolor{comment}{//}}
\DoxyCodeLine{00047\ \textcolor{comment}{//\ \ \ \ \ \ Priority\ search\ in\ kd-\/trees:}}
\DoxyCodeLine{00048\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Arya\ and\ Mount,\ \`{}\`{}Algorithms\ for\ fast\ vector\ quantization,''}}
\DoxyCodeLine{00049\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Proc.\ of\ DCC\ '93:\ Data\ Compression\ Conference,\ eds.\ J.\ A.}}
\DoxyCodeLine{00050\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Storer\ and\ M.\ Cohn,\ IEEE\ Press,\ 1993,\ 381-\/390.}}
\DoxyCodeLine{00051\ \textcolor{comment}{//}}
\DoxyCodeLine{00052\ \textcolor{comment}{//\ \ \ \ \ \ Approximate\ nearest\ neighbor\ search\ and\ bbd-\/trees:}}
\DoxyCodeLine{00053\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Arya,\ Mount,\ Netanyahu,\ Silverman,\ and\ Wu,\ \`{}\`{}An\ optimal}}
\DoxyCodeLine{00054\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ algorithm\ for\ approximate\ nearest\ neighbor\ searching,''}}
\DoxyCodeLine{00055\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ 5th\ Ann.\ ACM-\/SIAM\ Symposium\ on\ Discrete\ Algorithms,}}
\DoxyCodeLine{00056\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ 1994,\ 573-\/582.}}
\DoxyCodeLine{00057\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#ifndef\ ANN\_H}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#define\ ANN\_H}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#ifdef\ WIN32}}
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//\ For\ Microsoft\ Visual\ C++,\ externally\ accessible\ symbols\ must\ be}}
\DoxyCodeLine{00065\ \ \ \textcolor{comment}{//\ explicitly\ indicated\ with\ DLL\_API,\ which\ is\ somewhat\ like\ "{}extern."{}}}
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ The\ following\ ifdef\ block\ is\ the\ standard\ way\ of\ creating\ macros}}
\DoxyCodeLine{00068\ \ \ \textcolor{comment}{//\ which\ make\ exporting\ from\ a\ DLL\ simpler.\ All\ files\ within\ this\ DLL}}
\DoxyCodeLine{00069\ \ \ \textcolor{comment}{//\ are\ compiled\ with\ the\ DLL\_EXPORTS\ preprocessor\ symbol\ defined\ on\ the}}
\DoxyCodeLine{00070\ \ \ \textcolor{comment}{//\ command\ line.\ In\ contrast,\ projects\ that\ use\ (or\ import)\ the\ DLL}}
\DoxyCodeLine{00071\ \ \ \textcolor{comment}{//\ objects\ do\ not\ define\ the\ DLL\_EXPORTS\ symbol.\ This\ way\ any\ other}}
\DoxyCodeLine{00072\ \ \ \textcolor{comment}{//\ project\ whose\ source\ files\ include\ this\ file\ see\ DLL\_API\ functions\ as}}
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{//\ being\ imported\ from\ a\ DLL,\ wheras\ this\ DLL\ sees\ symbols\ defined\ with}}
\DoxyCodeLine{00074\ \ \ \textcolor{comment}{//\ this\ macro\ as\ being\ exported.}}
\DoxyCodeLine{00075\ \ \ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\ \ \#ifdef\ DLL\_EXPORTS}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\ \ \ \ \ \#define\ DLL\_API\ \_\_declspec(dllexport)}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\ \ \#else}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\ \ \ \ \#define\ DLL\_API\ \_\_declspec(dllimport)}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00081\ \ \ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{//\ DLL\_API\ is\ ignored\ for\ all\ other\ systems}}
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\ \ \#define\ DLL\_API}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00089\ \textcolor{comment}{//\ \ basic\ includes}}
\DoxyCodeLine{00090\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#include\ <cstdlib>}\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ standard\ lib\ includes}}
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\#include\ <cmath>}\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ math\ includes}}
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#include\ <iostream>}\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ I/O\ streams}}
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#include\ <cstring>}\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ C-\/style\ strings}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00098\ \textcolor{comment}{//\ Limits}}
\DoxyCodeLine{00099\ \textcolor{comment}{//\ There\ are\ a\ number\ of\ places\ where\ we\ use\ the\ maximum\ double\ value\ as}}
\DoxyCodeLine{00100\ \textcolor{comment}{//\ default\ initializers\ (and\ others\ may\ be\ used,\ depending\ on\ the}}
\DoxyCodeLine{00101\ \textcolor{comment}{//\ data/distance\ representation).\ These\ can\ usually\ be\ found\ in\ limits.h}}
\DoxyCodeLine{00102\ \textcolor{comment}{//\ (as\ LONG\_MAX,\ INT\_MAX)\ or\ in\ float.h\ (as\ DBL\_MAX,\ FLT\_MAX).}}
\DoxyCodeLine{00103\ \textcolor{comment}{//}}
\DoxyCodeLine{00104\ \textcolor{comment}{//\ Not\ all\ systems\ have\ these\ files.\ \ If\ you\ are\ using\ such\ a\ system,}}
\DoxyCodeLine{00105\ \textcolor{comment}{//\ you\ should\ set\ the\ preprocessor\ symbol\ ANN\_NO\_LIMITS\_H\ when}}
\DoxyCodeLine{00106\ \textcolor{comment}{//\ compiling,\ and\ modify\ the\ statements\ below\ to\ generate\ the}}
\DoxyCodeLine{00107\ \textcolor{comment}{//\ appropriate\ value.\ For\ practical\ purposes,\ this\ does\ not\ need\ to\ be}}
\DoxyCodeLine{00108\ \textcolor{comment}{//\ the\ maximum\ double\ value.\ It\ is\ sufficient\ that\ it\ be\ at\ least\ as}}
\DoxyCodeLine{00109\ \textcolor{comment}{//\ large\ than\ the\ maximum\ squared\ distance\ between\ between\ any\ two}}
\DoxyCodeLine{00110\ \textcolor{comment}{//\ points.}}
\DoxyCodeLine{00111\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#ifdef\ ANN\_NO\_LIMITS\_H\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ limits.h\ unavailable}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\ \ \#include\ <cvalues>}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ replacement\ for\ limits.h}}
\DoxyCodeLine{00114\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ ANN\_DBL\_MAX\ =\ MAXDOUBLE;\ \textcolor{comment}{//\ insert\ maximum\ double}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\ \ \#include\ <climits>}}
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\ \ \#include\ <cfloat>}}
\DoxyCodeLine{00118\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ ANN\_DBL\_MAX\ =\ DBL\_MAX;}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#define\ ANNversion\ \ \ \ \ \ "{}1.1.2"{}\ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ ANN\ version\ and\ information}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#define\ ANNversionCmt\ \ \ "{}"{}}}
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#define\ ANNcopyright\ \ \ \ "{}David\ M.\ Mount\ and\ Sunil\ Arya"{}}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#define\ ANNlatestRev\ \ \ \ "{}Jan\ 27,\ 2010"{}}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00127\ \textcolor{comment}{//\ \ ANNbool}}
\DoxyCodeLine{00128\ \textcolor{comment}{//\ \ This\ is\ a\ simple\ boolean\ type.\ Although\ ANSI\ C++\ is\ supposed}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\ \ to\ support\ the\ type\ bool,\ some\ compilers\ do\ not\ have\ it.}}
\DoxyCodeLine{00130\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{keyword}{enum}\ ANNbool\ \{ANNfalse\ =\ 0,\ ANNtrue\ =\ 1\};\ \textcolor{comment}{//\ ANN\ boolean\ type\ (non\ ANSI\ C++)}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00135\ \textcolor{comment}{//\ \ ANNcoord,\ ANNdist}}
\DoxyCodeLine{00136\ \textcolor{comment}{//\ \ \ \ \ \ ANNcoord\ and\ ANNdist\ are\ the\ types\ used\ for\ representing}}
\DoxyCodeLine{00137\ \textcolor{comment}{//\ \ \ \ \ \ point\ coordinates\ and\ distances.\ \ They\ can\ be\ modified\ by\ the}}
\DoxyCodeLine{00138\ \textcolor{comment}{//\ \ \ \ \ \ user,\ with\ some\ care.\ \ It\ is\ assumed\ that\ they\ are\ both\ numeric}}
\DoxyCodeLine{00139\ \textcolor{comment}{//\ \ \ \ \ \ types,\ and\ that\ ANNdist\ is\ generally\ of\ an\ equal\ or\ higher\ type}}
\DoxyCodeLine{00140\ \textcolor{comment}{//\ \ \ \ \ \ from\ ANNcoord.\ \ A\ variable\ of\ type\ ANNdist\ should\ be\ large}}
\DoxyCodeLine{00141\ \textcolor{comment}{//\ \ \ \ \ \ enough\ to\ store\ the\ sum\ of\ squared\ components\ of\ a\ variable}}
\DoxyCodeLine{00142\ \textcolor{comment}{//\ \ \ \ \ \ of\ type\ ANNcoord\ for\ the\ number\ of\ dimensions\ needed\ in\ the}}
\DoxyCodeLine{00143\ \textcolor{comment}{//\ \ \ \ \ \ application.\ \ For\ example,\ the\ following\ combinations\ are}}
\DoxyCodeLine{00144\ \textcolor{comment}{//\ \ \ \ \ \ legal:}}
\DoxyCodeLine{00145\ \textcolor{comment}{//}}
\DoxyCodeLine{00146\ \textcolor{comment}{//\ \ \ \ \ \ ANNcoord\ \ \ \ \ \ \ \ ANNdist}}
\DoxyCodeLine{00147\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/\ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00148\ \textcolor{comment}{//\ \ \ \ \ \ short\ \ \ \ \ \ \ \ \ \ \ short,\ int,\ long,\ float,\ double}}
\DoxyCodeLine{00149\ \textcolor{comment}{//\ \ \ \ \ \ int\ \ \ \ \ \ \ \ \ \ \ \ \ int,\ long,\ float,\ double}}
\DoxyCodeLine{00150\ \textcolor{comment}{//\ \ \ \ \ \ long\ \ \ \ \ \ \ \ \ \ \ \ long,\ float,\ double}}
\DoxyCodeLine{00151\ \textcolor{comment}{//\ \ \ \ \ \ float\ \ \ \ \ \ \ \ \ \ \ float,\ double}}
\DoxyCodeLine{00152\ \textcolor{comment}{//\ \ \ \ \ \ double\ \ \ \ \ \ \ \ \ \ double}}
\DoxyCodeLine{00153\ \textcolor{comment}{//}}
\DoxyCodeLine{00154\ \textcolor{comment}{//\ \ \ \ \ \ It\ is\ the\ user's\ responsibility\ to\ make\ sure\ that\ overflow\ does}}
\DoxyCodeLine{00155\ \textcolor{comment}{//\ \ \ \ \ \ not\ occur\ in\ distance\ calculation.}}
\DoxyCodeLine{00156\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{double}\ \ ANNcoord;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ coordinate\ data\ type}}
\DoxyCodeLine{00159\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{double}\ \ ANNdist;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ distance\ data\ type}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00162\ \textcolor{comment}{//\ \ ANNidx}}
\DoxyCodeLine{00163\ \textcolor{comment}{//\ \ \ \ \ \ ANNidx\ is\ a\ point\ index.\ \ When\ the\ data\ structure\ is\ built,\ the}}
\DoxyCodeLine{00164\ \textcolor{comment}{//\ \ \ \ \ \ points\ are\ given\ as\ an\ array.\ \ Nearest\ neighbor\ results\ are}}
\DoxyCodeLine{00165\ \textcolor{comment}{//\ \ \ \ \ \ returned\ as\ an\ integer\ index\ into\ this\ array.\ \ To\ make\ it}}
\DoxyCodeLine{00166\ \textcolor{comment}{//\ \ \ \ \ \ clearer\ when\ this\ is\ happening,\ we\ define\ the\ integer\ type}}
\DoxyCodeLine{00167\ \textcolor{comment}{//\ \ \ \ \ \ ANNidx.\ \ Indexing\ starts\ from\ 0.}}
\DoxyCodeLine{00168\ \textcolor{comment}{//\ \ \ \ \ \ }}
\DoxyCodeLine{00169\ \textcolor{comment}{//\ \ \ \ \ \ For\ fixed-\/radius\ near\ neighbor\ searching,\ it\ is\ possible\ that}}
\DoxyCodeLine{00170\ \textcolor{comment}{//\ \ \ \ \ \ there\ are\ not\ k\ nearest\ neighbors\ within\ the\ search\ radius.\ \ To}}
\DoxyCodeLine{00171\ \textcolor{comment}{//\ \ \ \ \ \ indicate\ this,\ the\ algorithm\ returns\ ANN\_NULL\_IDX\ as\ its\ result.}}
\DoxyCodeLine{00172\ \textcolor{comment}{//\ \ \ \ \ \ It\ should\ be\ distinguishable\ from\ any\ valid\ array\ index.}}
\DoxyCodeLine{00173\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{int}\ \ \ \ \ ANNidx;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ index}}
\DoxyCodeLine{00176\ \textcolor{keyword}{const}\ ANNidx\ \ \ \ ANN\_NULL\_IDX\ =\ -\/1;\ \ \ \ \ \ \textcolor{comment}{//\ a\ NULL\ point\ index}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00179\ \textcolor{comment}{//\ \ Infinite\ distance:}}
\DoxyCodeLine{00180\ \textcolor{comment}{//\ \ \ \ \ \ The\ code\ assumes\ that\ there\ is\ an\ "{}infinite\ distance"{}\ which\ it}}
\DoxyCodeLine{00181\ \textcolor{comment}{//\ \ \ \ \ \ uses\ to\ initialize\ distances\ before\ performing\ nearest\ neighbor}}
\DoxyCodeLine{00182\ \textcolor{comment}{//\ \ \ \ \ \ searches.\ \ It\ should\ be\ as\ larger\ or\ larger\ than\ any\ legitimate}}
\DoxyCodeLine{00183\ \textcolor{comment}{//\ \ \ \ \ \ nearest\ neighbor\ distance.}}
\DoxyCodeLine{00184\ \textcolor{comment}{//}}
\DoxyCodeLine{00185\ \textcolor{comment}{//\ \ \ \ \ \ On\ most\ systems,\ these\ should\ be\ found\ in\ the\ standard\ include}}
\DoxyCodeLine{00186\ \textcolor{comment}{//\ \ \ \ \ \ file\ <limits.h>\ or\ possibly\ <float.h>.\ \ If\ you\ do\ not\ have\ these}}
\DoxyCodeLine{00187\ \textcolor{comment}{//\ \ \ \ \ \ file,\ some\ suggested\ values\ are\ listed\ below,\ assuming\ 64-\/bit}}
\DoxyCodeLine{00188\ \textcolor{comment}{//\ \ \ \ \ \ long,\ 32-\/bit\ int\ and\ 16-\/bit\ short.}}
\DoxyCodeLine{00189\ \textcolor{comment}{//}}
\DoxyCodeLine{00190\ \textcolor{comment}{//\ \ \ \ \ \ ANNdist\ ANN\_DIST\_INF\ \ \ \ Values\ (see\ <limits.h>\ or\ <float.h>)}}
\DoxyCodeLine{00191\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00192\ \textcolor{comment}{//\ \ \ \ \ \ double\ \ DBL\_MAX\ \ \ \ \ \ \ \ \ 1.79769313486231570e+308}}
\DoxyCodeLine{00193\ \textcolor{comment}{//\ \ \ \ \ \ float\ \ \ FLT\_MAX\ \ \ \ \ \ \ \ \ 3.40282346638528860e+38}}
\DoxyCodeLine{00194\ \textcolor{comment}{//\ \ \ \ \ \ long\ \ \ \ LONG\_MAX\ \ \ \ \ \ \ \ 0x7fffffffffffffff}}
\DoxyCodeLine{00195\ \textcolor{comment}{//\ \ \ \ \ \ int\ \ \ \ \ INT\_MAX\ \ \ \ \ \ \ \ \ 0x7fffffff}}
\DoxyCodeLine{00196\ \textcolor{comment}{//\ \ \ \ \ \ short\ \ \ SHRT\_MAX\ \ \ \ \ \ \ \ 0x7fff}}
\DoxyCodeLine{00197\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \textcolor{keyword}{const}\ ANNdist\ \ \ ANN\_DIST\_INF\ =\ ANN\_DBL\_MAX;}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00202\ \textcolor{comment}{//\ \ Significant\ digits\ for\ tree\ dumps:}}
\DoxyCodeLine{00203\ \textcolor{comment}{//\ \ \ \ \ \ When\ floating\ point\ coordinates\ are\ used,\ the\ routine\ that\ dumps}}
\DoxyCodeLine{00204\ \textcolor{comment}{//\ \ \ \ \ \ a\ tree\ needs\ to\ know\ roughly\ how\ many\ significant\ digits\ there}}
\DoxyCodeLine{00205\ \textcolor{comment}{//\ \ \ \ \ \ are\ in\ a\ ANNcoord,\ so\ it\ can\ output\ points\ to\ full\ precision.}}
\DoxyCodeLine{00206\ \textcolor{comment}{//\ \ \ \ \ \ This\ is\ defined\ to\ be\ ANNcoordPrec.\ \ On\ most\ systems\ these}}
\DoxyCodeLine{00207\ \textcolor{comment}{//\ \ \ \ \ \ values\ can\ be\ found\ in\ the\ standard\ include\ files\ <limits.h>\ or}}
\DoxyCodeLine{00208\ \textcolor{comment}{//\ \ \ \ \ \ <float.h>.\ \ For\ integer\ types,\ the\ value\ is\ essentially\ ignored.}}
\DoxyCodeLine{00209\ \textcolor{comment}{//}}
\DoxyCodeLine{00210\ \textcolor{comment}{//\ \ \ \ \ \ ANNcoord\ ANNcoordPrec\ \ \ Values\ (see\ <limits.h>\ or\ <float.h>)}}
\DoxyCodeLine{00211\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00212\ \textcolor{comment}{//\ \ \ \ \ \ double\ \ \ DBL\_DIG\ \ \ \ \ \ \ \ 15}}
\DoxyCodeLine{00213\ \textcolor{comment}{//\ \ \ \ \ \ float\ \ \ \ FLT\_DIG\ \ \ \ \ \ \ \ 6}}
\DoxyCodeLine{00214\ \textcolor{comment}{//\ \ \ \ \ \ long\ \ \ \ \ doesn't\ matter\ 19}}
\DoxyCodeLine{00215\ \textcolor{comment}{//\ \ \ \ \ \ int\ \ \ \ \ \ doesn't\ matter\ 10}}
\DoxyCodeLine{00216\ \textcolor{comment}{//\ \ \ \ \ \ short\ \ \ \ doesn't\ matter\ 5}}
\DoxyCodeLine{00217\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \textcolor{preprocessor}{\#ifdef\ DBL\_DIG\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ number\ of\ sig.\ bits\ in\ ANNcoord}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ \ ANNcoordPrec\ \ \ =\ DBL\_DIG;}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ \ ANNcoordPrec\ \ \ =\ 15;\ \ \ \textcolor{comment}{//\ default\ precision}}
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00226\ \textcolor{comment}{//\ Self\ match?}}
\DoxyCodeLine{00227\ \textcolor{comment}{//\ \ In\ some\ applications,\ the\ nearest\ neighbor\ of\ a\ point\ is\ not}}
\DoxyCodeLine{00228\ \textcolor{comment}{//\ \ allowed\ to\ be\ the\ point\ itself.\ This\ occurs,\ for\ example,\ when}}
\DoxyCodeLine{00229\ \textcolor{comment}{//\ \ computing\ all\ nearest\ neighbors\ in\ a\ set.\ \ By\ setting\ the}}
\DoxyCodeLine{00230\ \textcolor{comment}{//\ \ parameter\ ANN\_ALLOW\_SELF\_MATCH\ to\ ANNfalse,\ the\ nearest\ neighbor}}
\DoxyCodeLine{00231\ \textcolor{comment}{//\ \ is\ the\ closest\ point\ whose\ distance\ from\ the\ query\ point\ is}}
\DoxyCodeLine{00232\ \textcolor{comment}{//\ \ strictly\ positive.}}
\DoxyCodeLine{00233\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \textcolor{keyword}{const}\ ANNbool\ \ \ ANN\_ALLOW\_SELF\_MATCH\ \ \ \ =\ ANNtrue;}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00238\ \textcolor{comment}{//\ \ Norms\ and\ metrics:}}
\DoxyCodeLine{00239\ \textcolor{comment}{//\ \ \ \ \ \ ANN\ supports\ any\ Minkowski\ norm\ for\ defining\ distance.\ \ In}}
\DoxyCodeLine{00240\ \textcolor{comment}{//\ \ \ \ \ \ particular,\ for\ any\ p\ >=\ 1,\ the\ L\_p\ Minkowski\ norm\ defines\ the}}
\DoxyCodeLine{00241\ \textcolor{comment}{//\ \ \ \ \ \ length\ of\ a\ d-\/vector\ (v0,\ v1,\ ...,\ v(d-\/1))\ to\ be}}
\DoxyCodeLine{00242\ \textcolor{comment}{//}}
\DoxyCodeLine{00243\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ (|v0|\string^p\ +\ |v1|\string^p\ +\ ...\ +\ |v(d-\/1)|\string^p)\string^(1/p),}}
\DoxyCodeLine{00244\ \textcolor{comment}{//}}
\DoxyCodeLine{00245\ \textcolor{comment}{//\ \ \ \ \ \ (where\ \string^\ denotes\ exponentiation,\ and\ |.|\ denotes\ absolute}}
\DoxyCodeLine{00246\ \textcolor{comment}{//\ \ \ \ \ \ value).\ \ The\ distance\ between\ two\ points\ is\ defined\ to\ be\ the}}
\DoxyCodeLine{00247\ \textcolor{comment}{//\ \ \ \ \ \ norm\ of\ the\ vector\ joining\ them.\ \ Some\ common\ distance\ metrics}}
\DoxyCodeLine{00248\ \textcolor{comment}{//\ \ \ \ \ \ include}}
\DoxyCodeLine{00249\ \textcolor{comment}{//}}
\DoxyCodeLine{00250\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Euclidean\ metric\ \ \ \ \ \ \ \ p\ =\ 2}}
\DoxyCodeLine{00251\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Manhattan\ metric\ \ \ \ \ \ \ \ p\ =\ 1}}
\DoxyCodeLine{00252\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Max\ metric\ \ \ \ \ \ \ \ \ \ \ \ \ \ p\ =\ infinity}}
\DoxyCodeLine{00253\ \textcolor{comment}{//}}
\DoxyCodeLine{00254\ \textcolor{comment}{//\ \ \ \ \ \ In\ the\ case\ of\ the\ max\ metric,\ the\ norm\ is\ computed\ by\ taking}}
\DoxyCodeLine{00255\ \textcolor{comment}{//\ \ \ \ \ \ the\ maxima\ of\ the\ absolute\ values\ of\ the\ components.\ \ ANN\ is}}
\DoxyCodeLine{00256\ \textcolor{comment}{//\ \ \ \ \ \ highly\ "{}coordinate-\/based"{}\ and\ does\ not\ support\ general\ distances}}
\DoxyCodeLine{00257\ \textcolor{comment}{//\ \ \ \ \ \ functions\ (e.g.\ those\ obeying\ just\ the\ triangle\ inequality).\ \ It}}
\DoxyCodeLine{00258\ \textcolor{comment}{//\ \ \ \ \ \ also\ does\ not\ support\ distance\ functions\ based\ on}}
\DoxyCodeLine{00259\ \textcolor{comment}{//\ \ \ \ \ \ inner-\/products.}}
\DoxyCodeLine{00260\ \textcolor{comment}{//}}
\DoxyCodeLine{00261\ \textcolor{comment}{//\ \ \ \ \ \ For\ the\ purpose\ of\ computing\ nearest\ neighbors,\ it\ is\ not}}
\DoxyCodeLine{00262\ \textcolor{comment}{//\ \ \ \ \ \ necessary\ to\ compute\ the\ final\ power\ (1/p).\ \ Thus\ the\ only}}
\DoxyCodeLine{00263\ \textcolor{comment}{//\ \ \ \ \ \ component\ that\ is\ used\ by\ the\ program\ is\ |v(i)|\string^p.}}
\DoxyCodeLine{00264\ \textcolor{comment}{//}}
\DoxyCodeLine{00265\ \textcolor{comment}{//\ \ \ \ \ \ ANN\ parameterizes\ the\ distance\ computation\ through\ the\ following}}
\DoxyCodeLine{00266\ \textcolor{comment}{//\ \ \ \ \ \ macros.\ \ (Macros\ are\ used\ rather\ than\ procedures\ for}}
\DoxyCodeLine{00267\ \textcolor{comment}{//\ \ \ \ \ \ efficiency.)\ Recall\ that\ the\ distance\ between\ two\ points\ is}}
\DoxyCodeLine{00268\ \textcolor{comment}{//\ \ \ \ \ \ given\ by\ the\ length\ of\ the\ vector\ joining\ them,\ and\ the\ length}}
\DoxyCodeLine{00269\ \textcolor{comment}{//\ \ \ \ \ \ or\ norm\ of\ a\ vector\ v\ is\ given\ by\ formula:}}
\DoxyCodeLine{00270\ \textcolor{comment}{//}}
\DoxyCodeLine{00271\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ |v|\ =\ ROOT(POW(v0)\ \#\ POW(v1)\ \#\ ...\ \#\ POW(v(d-\/1)))}}
\DoxyCodeLine{00272\ \textcolor{comment}{//}}
\DoxyCodeLine{00273\ \textcolor{comment}{//\ \ \ \ \ \ where\ ROOT,\ POW\ are\ unary\ functions\ and\ \#\ is\ an\ associative\ and}}
\DoxyCodeLine{00274\ \textcolor{comment}{//\ \ \ \ \ \ commutative\ binary\ operator\ mapping\ the\ following\ types:}}
\DoxyCodeLine{00275\ \textcolor{comment}{//}}
\DoxyCodeLine{00276\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ **\ \ POW:\ \ \ \ ANNcoord\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ ANNdist}}
\DoxyCodeLine{00277\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ **\ \ \#:\ \ \ \ \ \ ANNdist\ x\ ANNdist\ \ \ \ \ \ \ -\/-\/>\ ANNdist}}
\DoxyCodeLine{00278\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ **\ \ ROOT:\ \ \ ANNdist\ (>0)\ \ \ \ \ \ \ \ \ \ \ \ -\/-\/>\ double}}
\DoxyCodeLine{00279\ \textcolor{comment}{//}}
\DoxyCodeLine{00280\ \textcolor{comment}{//\ \ \ \ \ \ For\ early\ termination\ in\ distance\ calculation\ (partial\ distance}}
\DoxyCodeLine{00281\ \textcolor{comment}{//\ \ \ \ \ \ calculation)\ we\ assume\ that\ POW\ and\ \#\ together\ are\ monotonically}}
\DoxyCodeLine{00282\ \textcolor{comment}{//\ \ \ \ \ \ increasing\ on\ sequences\ of\ arguments,\ meaning\ that\ for\ all}}
\DoxyCodeLine{00283\ \textcolor{comment}{//\ \ \ \ \ \ v0..vk\ and\ y:}}
\DoxyCodeLine{00284\ \textcolor{comment}{//}}
\DoxyCodeLine{00285\ \textcolor{comment}{//\ \ \ \ \ \ POW(v0)\ \#...\#\ POW(vk)\ <=\ (POW(v0)\ \#...\#\ POW(vk))\ \#\ POW(y).}}
\DoxyCodeLine{00286\ \textcolor{comment}{//}}
\DoxyCodeLine{00287\ \textcolor{comment}{//\ \ Incremental\ Distance\ Calculation:}}
\DoxyCodeLine{00288\ \textcolor{comment}{//\ \ \ \ \ \ The\ program\ uses\ an\ optimized\ method\ of\ computing\ distances\ for}}
\DoxyCodeLine{00289\ \textcolor{comment}{//\ \ \ \ \ \ kd-\/trees\ and\ bd-\/trees,\ called\ incremental\ distance\ calculation.}}
\DoxyCodeLine{00290\ \textcolor{comment}{//\ \ \ \ \ \ It\ is\ used\ when\ distances\ are\ to\ be\ updated\ when\ only\ a\ single}}
\DoxyCodeLine{00291\ \textcolor{comment}{//\ \ \ \ \ \ coordinate\ of\ a\ point\ has\ been\ changed.\ \ In\ order\ to\ use\ this,}}
\DoxyCodeLine{00292\ \textcolor{comment}{//\ \ \ \ \ \ we\ assume\ that\ there\ is\ an\ incremental\ update\ function\ DIFF(x,y)}}
\DoxyCodeLine{00293\ \textcolor{comment}{//\ \ \ \ \ \ for\ \#,\ such\ that\ if:}}
\DoxyCodeLine{00294\ \textcolor{comment}{//}}
\DoxyCodeLine{00295\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ x0\ \#\ ...\ \#\ xi\ \#\ ...\ \#\ xk\ }}
\DoxyCodeLine{00296\ \textcolor{comment}{//}}
\DoxyCodeLine{00297\ \textcolor{comment}{//\ \ \ \ \ \ then\ if\ s'\ is\ equal\ to\ s\ but\ with\ xi\ replaced\ by\ y,\ that\ is,\ }}
\DoxyCodeLine{00298\ \textcolor{comment}{//\ \ \ \ \ \ }}
\DoxyCodeLine{00299\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s'\ =\ x0\ \#\ ...\ \#\ y\ \#\ ...\ \#\ xk}}
\DoxyCodeLine{00300\ \textcolor{comment}{//}}
\DoxyCodeLine{00301\ \textcolor{comment}{//\ \ \ \ \ \ then\ the\ length\ of\ s'\ can\ be\ computed\ by:}}
\DoxyCodeLine{00302\ \textcolor{comment}{//}}
\DoxyCodeLine{00303\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |s'|\ =\ |s|\ \#\ DIFF(xi,y).}}
\DoxyCodeLine{00304\ \textcolor{comment}{//}}
\DoxyCodeLine{00305\ \textcolor{comment}{//\ \ \ \ \ \ Thus,\ if\ \#\ is\ +\ then\ DIFF(xi,y)\ is\ (yi-\/x).\ \ For\ the\ L\_infinity}}
\DoxyCodeLine{00306\ \textcolor{comment}{//\ \ \ \ \ \ norm\ we\ make\ use\ of\ the\ fact\ that\ in\ the\ program\ this\ function}}
\DoxyCodeLine{00307\ \textcolor{comment}{//\ \ \ \ \ \ is\ only\ invoked\ when\ y\ >\ xi,\ and\ hence\ DIFF(xi,y)=y.}}
\DoxyCodeLine{00308\ \textcolor{comment}{//}}
\DoxyCodeLine{00309\ \textcolor{comment}{//\ \ \ \ \ \ Finally,\ for\ approximate\ nearest\ neighbor\ queries\ we\ assume}}
\DoxyCodeLine{00310\ \textcolor{comment}{//\ \ \ \ \ \ that\ POW\ and\ ROOT\ are\ related\ such\ that}}
\DoxyCodeLine{00311\ \textcolor{comment}{//}}
\DoxyCodeLine{00312\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v*ROOT(x)\ =\ ROOT(POW(v)*x)}}
\DoxyCodeLine{00313\ \textcolor{comment}{//}}
\DoxyCodeLine{00314\ \textcolor{comment}{//\ \ \ \ \ \ Here\ are\ the\ values\ for\ the\ various\ Minkowski\ norms:}}
\DoxyCodeLine{00315\ \textcolor{comment}{//}}
\DoxyCodeLine{00316\ \textcolor{comment}{//\ \ \ \ \ \ L\_p:\ \ \ \ p\ even:\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p\ odd:}}
\DoxyCodeLine{00317\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00318\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ POW(v)\ \ \ \ \ \ \ \ \ \ =\ v\string^p\ \ \ \ \ \ \ \ \ \ \ POW(v)\ \ \ \ \ \ \ \ \ \ =\ |v|\string^p}}
\DoxyCodeLine{00319\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ROOT(x)\ \ \ \ \ \ \ \ \ =\ x\string^(1/p)\ \ \ \ \ \ \ ROOT(x)\ \ \ \ \ \ \ \ \ =\ x\string^(1/p)}}
\DoxyCodeLine{00320\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ +\ \ \ \ \ \ \ \ \ \ \ \ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ +}}
\DoxyCodeLine{00321\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ DIFF(x,y)\ \ \ \ \ \ \ =\ y\ -\/\ x\ \ \ \ \ \ \ \ \ DIFF(x,y)\ \ \ \ \ \ \ =\ y\ -\/\ x\ }}
\DoxyCodeLine{00322\ \textcolor{comment}{//}}
\DoxyCodeLine{00323\ \textcolor{comment}{//\ \ \ \ \ \ L\_inf:}}
\DoxyCodeLine{00324\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ POW(v)\ \ \ \ \ \ \ \ \ \ =\ |v|}}
\DoxyCodeLine{00325\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ ROOT(x)\ \ \ \ \ \ \ \ \ =\ x}}
\DoxyCodeLine{00326\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ max}}
\DoxyCodeLine{00327\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ DIFF(x,y)\ \ \ \ \ \ \ =\ y}}
\DoxyCodeLine{00328\ \textcolor{comment}{//}}
\DoxyCodeLine{00329\ \textcolor{comment}{//\ \ \ \ \ \ By\ default\ the\ Euclidean\ norm\ is\ assumed.\ \ To\ change\ the\ norm,}}
\DoxyCodeLine{00330\ \textcolor{comment}{//\ \ \ \ \ \ uncomment\ the\ appropriate\ set\ of\ macros\ below.}}
\DoxyCodeLine{00331\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00334\ \textcolor{comment}{//\ \ Use\ the\ following\ for\ the\ Euclidean\ norm}}
\DoxyCodeLine{00335\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00336\ \textcolor{preprocessor}{\#define\ ANN\_POW(v)\ \ \ \ \ \ \ \ \ \ ((v)*(v))}}
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\#define\ ANN\_ROOT(x)\ \ \ \ \ \ \ \ \ sqrt(x)}}
\DoxyCodeLine{00338\ \textcolor{preprocessor}{\#define\ ANN\_SUM(x,y)\ \ \ \ \ \ \ \ ((x)\ +\ (y))}}
\DoxyCodeLine{00339\ \textcolor{preprocessor}{\#define\ ANN\_DIFF(x,y)\ \ \ \ \ \ \ ((y)\ -\/\ (x))}}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00342\ \textcolor{comment}{//\ \ Use\ the\ following\ for\ the\ L\_1\ (Manhattan)\ norm}}
\DoxyCodeLine{00343\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00344\ \textcolor{comment}{//\ \#define\ ANN\_POW(v)\ \ \ \ \ \ \ fabs(v)}}
\DoxyCodeLine{00345\ \textcolor{comment}{//\ \#define\ ANN\_ROOT(x)\ \ \ \ \ \ (x)}}
\DoxyCodeLine{00346\ \textcolor{comment}{//\ \#define\ ANN\_SUM(x,y)\ \ \ \ \ ((x)\ +\ (y))}}
\DoxyCodeLine{00347\ \textcolor{comment}{//\ \#define\ ANN\_DIFF(x,y)\ \ \ \ ((y)\ -\/\ (x))}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00350\ \textcolor{comment}{//\ \ Use\ the\ following\ for\ a\ general\ L\_p\ norm}}
\DoxyCodeLine{00351\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00352\ \textcolor{comment}{//\ \#define\ ANN\_POW(v)\ \ \ \ \ \ \ pow(fabs(v),p)}}
\DoxyCodeLine{00353\ \textcolor{comment}{//\ \#define\ ANN\_ROOT(x)\ \ \ \ \ \ pow(fabs(x),1/p)}}
\DoxyCodeLine{00354\ \textcolor{comment}{//\ \#define\ ANN\_SUM(x,y)\ \ \ \ \ ((x)\ +\ (y))}}
\DoxyCodeLine{00355\ \textcolor{comment}{//\ \#define\ ANN\_DIFF(x,y)\ \ \ \ ((y)\ -\/\ (x))}}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00358\ \textcolor{comment}{//\ \ Use\ the\ following\ for\ the\ L\_infinity\ (Max)\ norm}}
\DoxyCodeLine{00359\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00360\ \textcolor{comment}{//\ \#define\ ANN\_POW(v)\ \ \ \ \ \ \ fabs(v)}}
\DoxyCodeLine{00361\ \textcolor{comment}{//\ \#define\ ANN\_ROOT(x)\ \ \ \ \ \ (x)}}
\DoxyCodeLine{00362\ \textcolor{comment}{//\ \#define\ ANN\_SUM(x,y)\ \ \ \ \ ((x)\ >\ (y)\ ?\ (x)\ :\ (y))}}
\DoxyCodeLine{00363\ \textcolor{comment}{//\ \#define\ ANN\_DIFF(x,y)\ \ \ \ (y)}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00366\ \textcolor{comment}{//\ \ Array\ types}}
\DoxyCodeLine{00367\ \textcolor{comment}{//\ \ \ \ \ \ The\ following\ array\ types\ are\ of\ basic\ interest.\ \ A\ point\ is}}
\DoxyCodeLine{00368\ \textcolor{comment}{//\ \ \ \ \ \ just\ a\ dimensionless\ array\ of\ coordinates,\ a\ point\ array\ is\ a}}
\DoxyCodeLine{00369\ \textcolor{comment}{//\ \ \ \ \ \ dimensionless\ array\ of\ points.\ \ A\ distance\ array\ is\ a}}
\DoxyCodeLine{00370\ \textcolor{comment}{//\ \ \ \ \ \ dimensionless\ array\ of\ distances\ and\ an\ index\ array\ is\ a}}
\DoxyCodeLine{00371\ \textcolor{comment}{//\ \ \ \ \ \ dimensionless\ array\ of\ point\ indices.\ \ The\ latter\ two\ are\ used}}
\DoxyCodeLine{00372\ \textcolor{comment}{//\ \ \ \ \ \ when\ returning\ the\ results\ of\ k-\/nearest\ neighbor\ queries.}}
\DoxyCodeLine{00373\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \textcolor{keyword}{typedef}\ ANNcoord*\ ANNpoint;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ a\ point}}
\DoxyCodeLine{00376\ \textcolor{keyword}{typedef}\ ANNpoint*\ ANNpointArray;\ \ \ \ \textcolor{comment}{//\ an\ array\ of\ points\ }}
\DoxyCodeLine{00377\ \textcolor{keyword}{typedef}\ ANNdist*\ \ ANNdistArray;\ \ \ \ \ \textcolor{comment}{//\ an\ array\ of\ distances\ }}
\DoxyCodeLine{00378\ \textcolor{keyword}{typedef}\ ANNidx*\ \ \ ANNidxArray;\ \ \ \ \ \ \textcolor{comment}{//\ an\ array\ of\ point\ indices}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00381\ \textcolor{comment}{//\ \ Basic\ point\ and\ array\ utilities:}}
\DoxyCodeLine{00382\ \textcolor{comment}{//\ \ \ \ \ \ The\ following\ procedures\ are\ useful\ supplements\ to\ ANN's\ nearest}}
\DoxyCodeLine{00383\ \textcolor{comment}{//\ \ \ \ \ \ neighbor\ capabilities.}}
\DoxyCodeLine{00384\ \textcolor{comment}{//}}
\DoxyCodeLine{00385\ \textcolor{comment}{//\ \ \ \ \ \ annDist():}}
\DoxyCodeLine{00386\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Computes\ the\ (squared)\ distance\ between\ a\ pair\ of\ points.}}
\DoxyCodeLine{00387\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Note\ that\ this\ routine\ is\ not\ used\ internally\ by\ ANN\ for}}
\DoxyCodeLine{00388\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ computing\ distance\ calculations.\ \ For\ reasons\ of\ efficiency}}
\DoxyCodeLine{00389\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ this\ is\ done\ using\ incremental\ distance\ calculation.\ \ Thus,}}
\DoxyCodeLine{00390\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ this\ routine\ cannot\ be\ modified\ as\ a\ method\ of\ changing\ the}}
\DoxyCodeLine{00391\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ metric.}}
\DoxyCodeLine{00392\ \textcolor{comment}{//}}
\DoxyCodeLine{00393\ \textcolor{comment}{//\ \ \ \ \ \ Because\ points\ (somewhat\ like\ strings\ in\ C)\ are\ stored\ as}}
\DoxyCodeLine{00394\ \textcolor{comment}{//\ \ \ \ \ \ pointers.\ \ Consequently,\ creating\ and\ destroying\ copies\ of}}
\DoxyCodeLine{00395\ \textcolor{comment}{//\ \ \ \ \ \ points\ may\ require\ storage\ allocation.\ \ These\ procedures\ do}}
\DoxyCodeLine{00396\ \textcolor{comment}{//\ \ \ \ \ \ this.}}
\DoxyCodeLine{00397\ \textcolor{comment}{//}}
\DoxyCodeLine{00398\ \textcolor{comment}{//\ \ \ \ \ \ annAllocPt()\ and\ annDeallocPt():}}
\DoxyCodeLine{00399\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Allocate\ a\ deallocate\ storage\ for\ a\ single\ point,\ and}}
\DoxyCodeLine{00400\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ a\ pointer\ to\ it.\ \ The\ argument\ to\ AllocPt()\ is}}
\DoxyCodeLine{00401\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ used\ to\ initialize\ all\ components.}}
\DoxyCodeLine{00402\ \textcolor{comment}{//}}
\DoxyCodeLine{00403\ \textcolor{comment}{//\ \ \ \ \ \ annAllocPts()\ and\ annDeallocPts():}}
\DoxyCodeLine{00404\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Allocate\ and\ deallocate\ an\ array\ of\ points\ as\ well\ a}}
\DoxyCodeLine{00405\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ place\ to\ store\ their\ coordinates,\ and\ initializes\ the}}
\DoxyCodeLine{00406\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ points\ to\ point\ to\ their\ respective\ coordinates.\ \ It}}
\DoxyCodeLine{00407\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ allocates\ point\ storage\ in\ a\ contiguous\ block\ large}}
\DoxyCodeLine{00408\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ enough\ to\ store\ all\ the\ points.\ \ It\ performs\ no}}
\DoxyCodeLine{00409\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ initialization.}}
\DoxyCodeLine{00410\ \textcolor{comment}{//}}
\DoxyCodeLine{00411\ \textcolor{comment}{//\ \ \ \ \ \ annCopyPt():}}
\DoxyCodeLine{00412\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Creates\ a\ copy\ of\ a\ given\ point,\ allocating\ space\ for}}
\DoxyCodeLine{00413\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ the\ new\ point.\ \ It\ returns\ a\ pointer\ to\ the\ newly}}
\DoxyCodeLine{00414\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ allocated\ copy.}}
\DoxyCodeLine{00415\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00416\ \ \ \ }
\DoxyCodeLine{00417\ DLL\_API\ ANNdist\ annDist(}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dim,\ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension\ of\ space}}
\DoxyCodeLine{00419\ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ p,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ points}}
\DoxyCodeLine{00420\ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q);}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ DLL\_API\ ANNpoint\ annAllocPt(}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dim,\ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00424\ \ \ \ \ ANNcoord\ \ \ \ \ \ \ \ c\ =\ 0);\ \ \ \ \ \textcolor{comment}{//\ coordinate\ value\ (all\ equal)}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ DLL\_API\ ANNpointArray\ annAllocPts(}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dim);\ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ DLL\_API\ \textcolor{keywordtype}{void}\ annDeallocPt(}
\DoxyCodeLine{00431\ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ \&p);\ \ \ \ \ \ \ \ \textcolor{comment}{//\ deallocate\ 1\ point}}
\DoxyCodeLine{00432\ \ \ \ }
\DoxyCodeLine{00433\ DLL\_API\ \textcolor{keywordtype}{void}\ annDeallocPts(}
\DoxyCodeLine{00434\ \ \ \ \ ANNpointArray\ \ \ \&pa);\ \ \ \ \ \ \ \textcolor{comment}{//\ point\ array}}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ DLL\_API\ ANNpoint\ annCopyPt(}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dim,\ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00438\ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ source);\ \ \ \ \textcolor{comment}{//\ point\ to\ copy}}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00441\ \textcolor{comment}{//Overall\ structure:\ ANN\ supports\ a\ number\ of\ different\ data\ structures}}
\DoxyCodeLine{00442\ \textcolor{comment}{//for\ approximate\ and\ exact\ nearest\ neighbor\ searching.\ \ These\ are:}}
\DoxyCodeLine{00443\ \textcolor{comment}{//}}
\DoxyCodeLine{00444\ \textcolor{comment}{//\ \ \ \ \ \ ANNbruteForce\ \ \ A\ simple\ brute-\/force\ search\ structure.}}
\DoxyCodeLine{00445\ \textcolor{comment}{//\ \ \ \ \ \ ANNkd\_tree\ \ \ \ \ \ A\ kd-\/tree\ tree\ search\ structure.\ \ ANNbd\_tree}}
\DoxyCodeLine{00446\ \textcolor{comment}{//\ \ \ \ \ \ A\ bd-\/tree\ tree\ search\ structure\ (a\ kd-\/tree\ with\ shrink}}
\DoxyCodeLine{00447\ \textcolor{comment}{//\ \ \ \ \ \ capabilities).}}
\DoxyCodeLine{00448\ \textcolor{comment}{//}}
\DoxyCodeLine{00449\ \textcolor{comment}{//\ \ \ \ \ \ At\ a\ minimum,\ each\ of\ these\ data\ structures\ support\ k-\/nearest}}
\DoxyCodeLine{00450\ \textcolor{comment}{//\ \ \ \ \ \ neighbor\ queries.\ \ The\ nearest\ neighbor\ query,\ annkSearch,}}
\DoxyCodeLine{00451\ \textcolor{comment}{//\ \ \ \ \ \ returns\ an\ integer\ identifier\ and\ the\ distance\ to\ the\ nearest}}
\DoxyCodeLine{00452\ \textcolor{comment}{//\ \ \ \ \ \ neighbor(s)\ and\ annRangeSearch\ returns\ the\ nearest\ points\ that}}
\DoxyCodeLine{00453\ \textcolor{comment}{//\ \ \ \ \ \ lie\ within\ a\ given\ query\ ball.}}
\DoxyCodeLine{00454\ \textcolor{comment}{//}}
\DoxyCodeLine{00455\ \textcolor{comment}{//\ \ \ \ \ \ Each\ structure\ is\ built\ by\ invoking\ the\ appropriate\ constructor}}
\DoxyCodeLine{00456\ \textcolor{comment}{//\ \ \ \ \ \ and\ passing\ it\ (at\ a\ minimum)\ the\ array\ of\ points,\ the\ total}}
\DoxyCodeLine{00457\ \textcolor{comment}{//\ \ \ \ \ \ number\ of\ points\ and\ the\ dimension\ of\ the\ space.\ \ Each\ structure}}
\DoxyCodeLine{00458\ \textcolor{comment}{//\ \ \ \ \ \ is\ also\ assumed\ to\ support\ a\ destructor\ and\ member\ functions}}
\DoxyCodeLine{00459\ \textcolor{comment}{//\ \ \ \ \ \ that\ return\ basic\ information\ about\ the\ point\ set.}}
\DoxyCodeLine{00460\ \textcolor{comment}{//}}
\DoxyCodeLine{00461\ \textcolor{comment}{//\ \ \ \ \ \ Note\ that\ the\ array\ of\ points\ is\ not\ copied\ by\ the\ data}}
\DoxyCodeLine{00462\ \textcolor{comment}{//\ \ \ \ \ \ structure\ (for\ reasons\ of\ space\ efficiency),\ and\ it\ is\ assumed}}
\DoxyCodeLine{00463\ \textcolor{comment}{//\ \ \ \ \ \ to\ be\ constant\ throughout\ the\ lifetime\ of\ the\ search\ structure.}}
\DoxyCodeLine{00464\ \textcolor{comment}{//}}
\DoxyCodeLine{00465\ \textcolor{comment}{//\ \ \ \ \ \ The\ search\ algorithm,\ annkSearch,\ is\ given\ the\ query\ point\ (q),}}
\DoxyCodeLine{00466\ \textcolor{comment}{//\ \ \ \ \ \ and\ the\ desired\ number\ of\ nearest\ neighbors\ to\ report\ (k),\ and}}
\DoxyCodeLine{00467\ \textcolor{comment}{//\ \ \ \ \ \ the\ error\ bound\ (eps)\ (whose\ default\ value\ is\ 0,\ implying\ exact}}
\DoxyCodeLine{00468\ \textcolor{comment}{//\ \ \ \ \ \ nearest\ neighbors).\ \ It\ returns\ two\ arrays\ which\ are\ assumed\ to}}
\DoxyCodeLine{00469\ \textcolor{comment}{//\ \ \ \ \ \ contain\ at\ least\ k\ elements:\ one\ (nn\_idx)\ contains\ the\ indices}}
\DoxyCodeLine{00470\ \textcolor{comment}{//\ \ \ \ \ \ (within\ the\ point\ array)\ of\ the\ nearest\ neighbors\ and\ the\ other}}
\DoxyCodeLine{00471\ \textcolor{comment}{//\ \ \ \ \ \ (dd)\ contains\ the\ squared\ distances\ to\ these\ nearest\ neighbors.}}
\DoxyCodeLine{00472\ \textcolor{comment}{//}}
\DoxyCodeLine{00473\ \textcolor{comment}{//\ \ \ \ \ \ The\ search\ algorithm,\ annkFRSearch,\ is\ a\ fixed-\/radius\ kNN}}
\DoxyCodeLine{00474\ \textcolor{comment}{//\ \ \ \ \ \ search.\ \ In\ addition\ to\ a\ query\ point,\ it\ is\ given\ a\ (squared)}}
\DoxyCodeLine{00475\ \textcolor{comment}{//\ \ \ \ \ \ radius\ bound.\ \ (This\ is\ done\ for\ consistency,\ because\ the\ search}}
\DoxyCodeLine{00476\ \textcolor{comment}{//\ \ \ \ \ \ returns\ distances\ as\ squared\ quantities.)\ It\ does\ two\ things.}}
\DoxyCodeLine{00477\ \textcolor{comment}{//\ \ \ \ \ \ First,\ it\ computes\ the\ k\ nearest\ neighbors\ within\ the\ radius}}
\DoxyCodeLine{00478\ \textcolor{comment}{//\ \ \ \ \ \ bound,\ and\ second,\ it\ returns\ the\ total\ number\ of\ points\ lying}}
\DoxyCodeLine{00479\ \textcolor{comment}{//\ \ \ \ \ \ within\ the\ radius\ bound.\ It\ is\ permitted\ to\ set\ k\ =\ 0,\ in\ which}}
\DoxyCodeLine{00480\ \textcolor{comment}{//\ \ \ \ \ \ case\ it\ effectively\ answers\ a\ range\ counting\ query.\ \ If\ the}}
\DoxyCodeLine{00481\ \textcolor{comment}{//\ \ \ \ \ \ error\ bound\ epsilon\ is\ positive,\ then\ the\ search\ is\ approximate}}
\DoxyCodeLine{00482\ \textcolor{comment}{//\ \ \ \ \ \ in\ the\ sense\ that\ it\ is\ free\ to\ ignore\ any\ point\ that\ lies}}
\DoxyCodeLine{00483\ \textcolor{comment}{//\ \ \ \ \ \ outside\ a\ ball\ of\ radius\ r/(1+epsilon),\ where\ r\ is\ the\ given}}
\DoxyCodeLine{00484\ \textcolor{comment}{//\ \ \ \ \ \ (unsquared)\ radius\ bound.}}
\DoxyCodeLine{00485\ \textcolor{comment}{//}}
\DoxyCodeLine{00486\ \textcolor{comment}{//\ \ \ \ \ \ The\ generic\ object\ from\ which\ all\ the\ search\ structures\ are}}
\DoxyCodeLine{00487\ \textcolor{comment}{//\ \ \ \ \ \ dervied\ is\ given\ below.\ \ It\ is\ a\ virtual\ object,\ and\ is\ useless}}
\DoxyCodeLine{00488\ \textcolor{comment}{//\ \ \ \ \ \ by\ itself.}}
\DoxyCodeLine{00489\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \textcolor{keyword}{class\ }DLL\_API\ \mbox{\hyperlink{class_a_n_npoint_set}{ANNpointSet}}\ \{}
\DoxyCodeLine{00492\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_a_n_npoint_set}{\string~ANNpointSet}}()\ \{\}\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ virtual\ distructor}}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ annkSearch(\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ approx\ k\ near\ neighbor\ search}}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ query\ point}}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ near\ neighbors\ to\ return}}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ )\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ pure\ virtual\ (defined\ elsewhere)}}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ annkFRSearch(\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ approx\ fixed-\/radius\ kNN\ search}}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ query\ point}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ ANNdist\ \ \ \ \ \ \ \ \ sqRad,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ squared\ radius}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k\ =\ 0,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ near\ neighbors\ to\ return}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx\ =\ NULL,\ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd\ =\ NULL,\ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ )\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ pure\ virtual\ (defined\ elsewhere)}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ theDim()\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ dimension\ of\ space}}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ nPoints()\ =\ 0;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ number\ of\ points}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ pointer\ to\ points}}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keyword}{virtual}\ ANNpointArray\ thePoints()\ =\ 0;}
\DoxyCodeLine{00516\ \};}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00519\ \textcolor{comment}{//\ \ Brute-\/force\ nearest\ neighbor\ search:}}
\DoxyCodeLine{00520\ \textcolor{comment}{//\ \ \ \ \ \ The\ brute-\/force\ search\ structure\ is\ very\ simple\ but\ inefficient.}}
\DoxyCodeLine{00521\ \textcolor{comment}{//\ \ \ \ \ \ It\ has\ been\ provided\ primarily\ for\ the\ sake\ of\ comparison\ with}}
\DoxyCodeLine{00522\ \textcolor{comment}{//\ \ \ \ \ \ and\ validation\ of\ the\ more\ complex\ search\ structures.}}
\DoxyCodeLine{00523\ \textcolor{comment}{//}}
\DoxyCodeLine{00524\ \textcolor{comment}{//\ \ \ \ \ \ Query\ processing\ is\ the\ same\ as\ described\ above,\ but\ the\ value}}
\DoxyCodeLine{00525\ \textcolor{comment}{//\ \ \ \ \ \ of\ epsilon\ is\ ignored,\ since\ all\ distance\ calculations\ are}}
\DoxyCodeLine{00526\ \textcolor{comment}{//\ \ \ \ \ \ performed\ exactly.}}
\DoxyCodeLine{00527\ \textcolor{comment}{//}}
\DoxyCodeLine{00528\ \textcolor{comment}{//\ \ \ \ \ \ WARNING:\ This\ data\ structure\ is\ very\ slow,\ and\ should\ not\ be}}
\DoxyCodeLine{00529\ \textcolor{comment}{//\ \ \ \ \ \ used\ unless\ the\ number\ of\ points\ is\ very\ small.}}
\DoxyCodeLine{00530\ \textcolor{comment}{//}}
\DoxyCodeLine{00531\ \textcolor{comment}{//\ \ \ \ \ \ Internal\ information:}}
\DoxyCodeLine{00532\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00533\ \textcolor{comment}{//\ \ \ \ \ \ This\ data\ structure\ bascially\ consists\ of\ the\ array\ of\ points}}
\DoxyCodeLine{00534\ \textcolor{comment}{//\ \ \ \ \ \ (each\ a\ pointer\ to\ an\ array\ of\ coordinates).\ \ The\ search\ is}}
\DoxyCodeLine{00535\ \textcolor{comment}{//\ \ \ \ \ \ performed\ by\ a\ simple\ linear\ scan\ of\ all\ the\ points.}}
\DoxyCodeLine{00536\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \textcolor{keyword}{class\ }DLL\_API\ \mbox{\hyperlink{class_a_n_nbrute_force}{ANNbruteForce}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_a_n_npoint_set}{ANNpointSet}}\ \{}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dim;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n\_pts;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00541\ \ \ \ \ ANNpointArray\ \ \ pts;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ array}}
\DoxyCodeLine{00542\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00543\ \ \ \ \ \mbox{\hyperlink{class_a_n_nbrute_force}{ANNbruteForce}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ constructor\ from\ point\ array}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ ANNpointArray\ \ \ pa,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ array}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dd);\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \ \ \mbox{\hyperlink{class_a_n_nbrute_force}{\string~ANNbruteForce}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ destructor}}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{keywordtype}{void}\ annkSearch(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ approx\ k\ near\ neighbor\ search}}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ query\ point}}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ near\ neighbors\ to\ return}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0);\ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keywordtype}{int}\ annkFRSearch(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ approx\ fixed-\/radius\ kNN\ search}}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ query\ point}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ ANNdist\ \ \ \ \ \ \ \ \ sqRad,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ squared\ radius}}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k\ =\ 0,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ near\ neighbors\ to\ return}}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx\ =\ NULL,\ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd\ =\ NULL,\ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0);\ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keywordtype}{int}\ theDim()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ dimension\ of\ space}}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ dim;\ \}}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keywordtype}{int}\ nPoints()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ number\ of\ points}}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ n\_pts;\ \}}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ \ \ ANNpointArray\ thePoints()\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ pointer\ to\ points}}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \{\ \ \textcolor{keywordflow}{return}\ pts;\ \ \}}
\DoxyCodeLine{00573\ \};}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00576\ \textcolor{comment}{//\ kd-\/\ and\ bd-\/tree\ splitting\ and\ shrinking\ rules}}
\DoxyCodeLine{00577\ \textcolor{comment}{//\ \ \ \ \ \ kd-\/trees\ supports\ a\ collection\ of\ different\ splitting\ rules.}}
\DoxyCodeLine{00578\ \textcolor{comment}{//\ \ \ \ \ \ In\ addition\ to\ the\ standard\ kd-\/tree\ splitting\ rule\ proposed}}
\DoxyCodeLine{00579\ \textcolor{comment}{//\ \ \ \ \ \ by\ Friedman,\ Bentley,\ and\ Finkel,\ we\ have\ introduced\ a}}
\DoxyCodeLine{00580\ \textcolor{comment}{//\ \ \ \ \ \ number\ of\ other\ splitting\ rules,\ which\ seem\ to\ perform}}
\DoxyCodeLine{00581\ \textcolor{comment}{//\ \ \ \ \ \ as\ well\ or\ better\ (for\ the\ distributions\ we\ have\ tested).}}
\DoxyCodeLine{00582\ \textcolor{comment}{//}}
\DoxyCodeLine{00583\ \textcolor{comment}{//\ \ \ \ \ \ The\ splitting\ methods\ given\ below\ allow\ the\ user\ to\ tailor}}
\DoxyCodeLine{00584\ \textcolor{comment}{//\ \ \ \ \ \ the\ data\ structure\ to\ the\ particular\ data\ set.\ \ They\ are}}
\DoxyCodeLine{00585\ \textcolor{comment}{//\ \ \ \ \ \ are\ described\ in\ greater\ details\ in\ the\ kd\_split.cc\ source}}
\DoxyCodeLine{00586\ \textcolor{comment}{//\ \ \ \ \ \ file.\ \ The\ method\ ANN\_KD\_SUGGEST\ is\ the\ method\ chosen\ (rather}}
\DoxyCodeLine{00587\ \textcolor{comment}{//\ \ \ \ \ \ subjectively)\ by\ the\ implementors\ as\ the\ one\ giving\ the}}
\DoxyCodeLine{00588\ \textcolor{comment}{//\ \ \ \ \ \ fastest\ performance,\ and\ is\ the\ default\ splitting\ method.}}
\DoxyCodeLine{00589\ \textcolor{comment}{//}}
\DoxyCodeLine{00590\ \textcolor{comment}{//\ \ \ \ \ \ As\ with\ splitting\ rules,\ there\ are\ a\ number\ of\ different}}
\DoxyCodeLine{00591\ \textcolor{comment}{//\ \ \ \ \ \ shrinking\ rules.\ \ The\ shrinking\ rule\ ANN\_BD\_NONE\ does\ no}}
\DoxyCodeLine{00592\ \textcolor{comment}{//\ \ \ \ \ \ shrinking\ (and\ hence\ produces\ a\ kd-\/tree\ tree).\ \ The\ rule}}
\DoxyCodeLine{00593\ \textcolor{comment}{//\ \ \ \ \ \ ANN\_BD\_SUGGEST\ uses\ the\ implementors\ favorite\ rule.}}
\DoxyCodeLine{00594\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \textcolor{keyword}{enum}\ ANNsplitRule\ \{}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ ANN\_KD\_STD\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0,\ \ \ \ \textcolor{comment}{//\ the\ optimized\ kd-\/splitting\ rule}}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ ANN\_KD\_MIDPT\ \ \ \ \ \ \ \ \ \ \ \ =\ 1,\ \ \ \ \textcolor{comment}{//\ midpoint\ split}}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ ANN\_KD\_FAIR\ \ \ \ \ \ \ \ \ \ \ \ \ =\ 2,\ \ \ \ \textcolor{comment}{//\ fair\ split}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ ANN\_KD\_SL\_MIDPT\ \ \ \ \ \ \ \ \ =\ 3,\ \ \ \ \textcolor{comment}{//\ sliding\ midpoint\ splitting\ method}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ ANN\_KD\_SL\_FAIR\ \ \ \ \ \ \ \ \ \ =\ 4,\ \ \ \ \textcolor{comment}{//\ sliding\ fair\ split\ method}}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ ANN\_KD\_SUGGEST\ \ \ \ \ \ \ \ \ \ =\ 5\};\ \ \ \textcolor{comment}{//\ the\ authors'\ suggestion\ for\ best}}
\DoxyCodeLine{00603\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ANN\_N\_SPLIT\_RULES\ \ \ \ \ =\ 6;\ \ \ \ \textcolor{comment}{//\ number\ of\ split\ rules}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \textcolor{keyword}{enum}\ ANNshrinkRule\ \{}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ ANN\_BD\_NONE\ \ \ \ \ \ \ \ \ \ \ \ \ =\ 0,\ \ \ \ \textcolor{comment}{//\ no\ shrinking\ at\ all\ (just\ kd-\/tree)}}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ ANN\_BD\_SIMPLE\ \ \ \ \ \ \ \ \ \ \ =\ 1,\ \ \ \ \textcolor{comment}{//\ simple\ splitting}}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ ANN\_BD\_CENTROID\ \ \ \ \ \ \ \ \ =\ 2,\ \ \ \ \textcolor{comment}{//\ centroid\ splitting}}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ ANN\_BD\_SUGGEST\ \ \ \ \ \ \ \ \ \ =\ 3\};\ \ \ \textcolor{comment}{//\ the\ authors'\ suggested\ choice}}
\DoxyCodeLine{00610\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ANN\_N\_SHRINK\_RULES\ \ \ \ =\ 4;\ \ \ \ \textcolor{comment}{//\ number\ of\ shrink\ rules}}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00613\ \textcolor{comment}{//\ \ kd-\/tree:}}
\DoxyCodeLine{00614\ \textcolor{comment}{//\ \ \ \ \ \ The\ main\ search\ data\ structure\ supported\ by\ ANN\ is\ a\ kd-\/tree.}}
\DoxyCodeLine{00615\ \textcolor{comment}{//\ \ \ \ \ \ The\ main\ constructor\ is\ given\ a\ set\ of\ points\ and\ a\ choice\ of}}
\DoxyCodeLine{00616\ \textcolor{comment}{//\ \ \ \ \ \ splitting\ method\ to\ use\ in\ building\ the\ tree.}}
\DoxyCodeLine{00617\ \textcolor{comment}{//}}
\DoxyCodeLine{00618\ \textcolor{comment}{//\ \ \ \ \ \ Construction:}}
\DoxyCodeLine{00619\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00620\ \textcolor{comment}{//\ \ \ \ \ \ The\ constructor\ is\ given\ the\ point\ array,\ number\ of\ points,}}
\DoxyCodeLine{00621\ \textcolor{comment}{//\ \ \ \ \ \ dimension,\ bucket\ size\ (default\ =\ 1),\ and\ the\ splitting\ rule}}
\DoxyCodeLine{00622\ \textcolor{comment}{//\ \ \ \ \ \ (default\ =\ ANN\_KD\_SUGGEST).\ \ The\ point\ array\ is\ not\ copied,\ and}}
\DoxyCodeLine{00623\ \textcolor{comment}{//\ \ \ \ \ \ is\ assumed\ to\ be\ kept\ constant\ throughout\ the\ lifetime\ of\ the}}
\DoxyCodeLine{00624\ \textcolor{comment}{//\ \ \ \ \ \ search\ structure.\ \ There\ is\ also\ a\ "{}load"{}\ constructor\ that}}
\DoxyCodeLine{00625\ \textcolor{comment}{//\ \ \ \ \ \ builds\ a\ tree\ from\ a\ file\ description\ that\ was\ created\ by\ the}}
\DoxyCodeLine{00626\ \textcolor{comment}{//\ \ \ \ \ \ Dump\ operation.}}
\DoxyCodeLine{00627\ \textcolor{comment}{//}}
\DoxyCodeLine{00628\ \textcolor{comment}{//\ \ \ \ \ \ Search:}}
\DoxyCodeLine{00629\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00630\ \textcolor{comment}{//\ \ \ \ \ \ There\ are\ two\ search\ methods:}}
\DoxyCodeLine{00631\ \textcolor{comment}{//}}
\DoxyCodeLine{00632\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Standard\ search\ (annkSearch()):}}
\DoxyCodeLine{00633\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Searches\ nodes\ in\ tree-\/traversal\ order,\ always\ visiting}}
\DoxyCodeLine{00634\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ the\ closer\ child\ first.}}
\DoxyCodeLine{00635\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ Priority\ search\ (annkPriSearch()):}}
\DoxyCodeLine{00636\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ Searches\ nodes\ in\ order\ of\ increasing\ distance\ of\ the}}
\DoxyCodeLine{00637\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ associated\ cell\ from\ the\ query\ point.\ \ For\ many}}
\DoxyCodeLine{00638\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ distributions\ the\ standard\ search\ seems\ to\ work\ just}}
\DoxyCodeLine{00639\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ fine,\ but\ priority\ search\ is\ safer\ for\ worst-\/case}}
\DoxyCodeLine{00640\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ performance.}}
\DoxyCodeLine{00641\ \textcolor{comment}{//}}
\DoxyCodeLine{00642\ \textcolor{comment}{//\ \ \ \ \ \ Printing:}}
\DoxyCodeLine{00643\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00644\ \textcolor{comment}{//\ \ \ \ \ \ There\ are\ two\ methods\ provided\ for\ printing\ the\ tree.\ \ Print()}}
\DoxyCodeLine{00645\ \textcolor{comment}{//\ \ \ \ \ \ is\ used\ to\ produce\ a\ "{}human-\/readable"{}\ display\ of\ the\ tree,\ with}}
\DoxyCodeLine{00646\ \textcolor{comment}{//\ \ \ \ \ \ indenation,\ which\ is\ handy\ for\ debugging.\ \ Dump()\ produces\ a}}
\DoxyCodeLine{00647\ \textcolor{comment}{//\ \ \ \ \ \ format\ that\ is\ suitable\ reading\ by\ another\ program.\ \ There\ is\ a}}
\DoxyCodeLine{00648\ \textcolor{comment}{//\ \ \ \ \ \ "{}load"{}\ constructor,\ which\ constructs\ a\ tree\ which\ is\ assumed\ to}}
\DoxyCodeLine{00649\ \textcolor{comment}{//\ \ \ \ \ \ have\ been\ saved\ by\ the\ Dump()\ procedure.}}
\DoxyCodeLine{00650\ \textcolor{comment}{//\ \ \ \ \ \ }}
\DoxyCodeLine{00651\ \textcolor{comment}{//\ \ \ \ \ \ Performance\ and\ Structure\ Statistics:}}
\DoxyCodeLine{00652\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00653\ \textcolor{comment}{//\ \ \ \ \ \ The\ procedure\ getStats()\ collects\ statistics\ information\ on\ the}}
\DoxyCodeLine{00654\ \textcolor{comment}{//\ \ \ \ \ \ tree\ (its\ size,\ height,\ etc.)\ \ See\ ANNperf.h\ for\ information\ on}}
\DoxyCodeLine{00655\ \textcolor{comment}{//\ \ \ \ \ \ the\ stats\ structure\ it\ returns.}}
\DoxyCodeLine{00656\ \textcolor{comment}{//}}
\DoxyCodeLine{00657\ \textcolor{comment}{//\ \ \ \ \ \ Internal\ information:}}
\DoxyCodeLine{00658\ \textcolor{comment}{//\ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00659\ \textcolor{comment}{//\ \ \ \ \ \ The\ data\ structure\ consists\ of\ three\ major\ chunks\ of\ storage.}}
\DoxyCodeLine{00660\ \textcolor{comment}{//\ \ \ \ \ \ The\ first\ (implicit)\ storage\ are\ the\ points\ themselves\ (pts),}}
\DoxyCodeLine{00661\ \textcolor{comment}{//\ \ \ \ \ \ which\ have\ been\ provided\ by\ the\ users\ as\ an\ argument\ to\ the}}
\DoxyCodeLine{00662\ \textcolor{comment}{//\ \ \ \ \ \ constructor,\ or\ are\ allocated\ dynamically\ if\ the\ tree\ is\ built}}
\DoxyCodeLine{00663\ \textcolor{comment}{//\ \ \ \ \ \ using\ the\ load\ constructor).\ \ These\ should\ not\ be\ changed\ during}}
\DoxyCodeLine{00664\ \textcolor{comment}{//\ \ \ \ \ \ the\ lifetime\ of\ the\ search\ structure.\ \ It\ is\ the\ user's}}
\DoxyCodeLine{00665\ \textcolor{comment}{//\ \ \ \ \ \ responsibility\ to\ delete\ these\ after\ the\ tree\ is\ destroyed.}}
\DoxyCodeLine{00666\ \textcolor{comment}{//}}
\DoxyCodeLine{00667\ \textcolor{comment}{//\ \ \ \ \ \ The\ second\ is\ the\ tree\ itself\ (which\ is\ dynamically\ allocated\ in}}
\DoxyCodeLine{00668\ \textcolor{comment}{//\ \ \ \ \ \ the\ constructor)\ and\ is\ given\ as\ a\ pointer\ to\ its\ root\ node}}
\DoxyCodeLine{00669\ \textcolor{comment}{//\ \ \ \ \ \ (root).\ \ These\ nodes\ are\ automatically\ deallocated\ when\ the\ tree}}
\DoxyCodeLine{00670\ \textcolor{comment}{//\ \ \ \ \ \ is\ deleted.\ \ See\ the\ file\ src/kd\_tree.h\ for\ further\ information}}
\DoxyCodeLine{00671\ \textcolor{comment}{//\ \ \ \ \ \ on\ the\ structure\ of\ the\ tree\ nodes.}}
\DoxyCodeLine{00672\ \textcolor{comment}{//}}
\DoxyCodeLine{00673\ \textcolor{comment}{//\ \ \ \ \ \ Each\ leaf\ of\ the\ tree\ does\ not\ contain\ a\ pointer\ directly\ to\ a}}
\DoxyCodeLine{00674\ \textcolor{comment}{//\ \ \ \ \ \ point,\ but\ rather\ contains\ a\ pointer\ to\ a\ "{}bucket"{},\ which\ is\ an}}
\DoxyCodeLine{00675\ \textcolor{comment}{//\ \ \ \ \ \ array\ consisting\ of\ point\ indices.\ \ The\ third\ major\ chunk\ of}}
\DoxyCodeLine{00676\ \textcolor{comment}{//\ \ \ \ \ \ storage\ is\ an\ array\ (pidx),\ which\ is\ a\ large\ array\ in\ which\ all}}
\DoxyCodeLine{00677\ \textcolor{comment}{//\ \ \ \ \ \ these\ bucket\ subarrays\ reside.\ \ (The\ reason\ for\ storing\ them}}
\DoxyCodeLine{00678\ \textcolor{comment}{//\ \ \ \ \ \ separately\ is\ the\ buckets\ are\ typically\ small,\ but\ of\ varying}}
\DoxyCodeLine{00679\ \textcolor{comment}{//\ \ \ \ \ \ sizes.\ \ This\ was\ done\ to\ avoid\ fragmentation.)\ \ This\ array\ is}}
\DoxyCodeLine{00680\ \textcolor{comment}{//\ \ \ \ \ \ also\ deallocated\ when\ the\ tree\ is\ deleted.}}
\DoxyCodeLine{00681\ \textcolor{comment}{//}}
\DoxyCodeLine{00682\ \textcolor{comment}{//\ \ \ \ \ \ In\ addition\ to\ this,\ the\ tree\ consists\ of\ a\ number\ of\ other}}
\DoxyCodeLine{00683\ \textcolor{comment}{//\ \ \ \ \ \ pieces\ of\ information\ which\ are\ used\ in\ searching\ and\ for}}
\DoxyCodeLine{00684\ \textcolor{comment}{//\ \ \ \ \ \ subsequent\ tree\ operations.\ \ These\ consist\ of\ the\ following:}}
\DoxyCodeLine{00685\ \textcolor{comment}{//}}
\DoxyCodeLine{00686\ \textcolor{comment}{//\ \ \ \ \ \ dim\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dimension\ of\ space}}
\DoxyCodeLine{00687\ \textcolor{comment}{//\ \ \ \ \ \ n\_pts\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Number\ of\ points\ currently\ in\ the\ tree}}
\DoxyCodeLine{00688\ \textcolor{comment}{//\ \ \ \ \ \ n\_max\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Maximum\ number\ of\ points\ that\ are\ allowed}}
\DoxyCodeLine{00689\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ the\ tree}}
\DoxyCodeLine{00690\ \textcolor{comment}{//\ \ \ \ \ \ bkt\_size\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Maximum\ bucket\ size\ (no.\ of\ points\ per\ leaf)}}
\DoxyCodeLine{00691\ \textcolor{comment}{//\ \ \ \ \ \ bnd\_box\_lo\ \ \ \ \ \ \ \ \ \ \ \ \ \ Bounding\ box\ low\ point}}
\DoxyCodeLine{00692\ \textcolor{comment}{//\ \ \ \ \ \ bnd\_box\_hi\ \ \ \ \ \ \ \ \ \ \ \ \ \ Bounding\ box\ high\ point}}
\DoxyCodeLine{00693\ \textcolor{comment}{//\ \ \ \ \ \ splitRule\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Splitting\ method\ used}}
\DoxyCodeLine{00694\ \textcolor{comment}{//}}
\DoxyCodeLine{00695\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00698\ \textcolor{comment}{//\ Some\ types\ and\ objects\ used\ by\ kd-\/tree\ functions}}
\DoxyCodeLine{00699\ \textcolor{comment}{//\ See\ src/kd\_tree.h\ and\ src/kd\_tree.cpp\ for\ definitions}}
\DoxyCodeLine{00700\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00701\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_a_n_nkd_stats}{ANNkdStats}};\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ stats\ on\ kd-\/tree}}
\DoxyCodeLine{00702\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_a_n_nkd__node}{ANNkd\_node}};\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ generic\ node\ in\ a\ kd-\/tree}}
\DoxyCodeLine{00703\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_a_n_nkd__node}{ANNkd\_node}}*\ \ \ \mbox{\hyperlink{class_a_n_nkd__node}{ANNkd\_ptr}};\ \textcolor{comment}{//\ pointer\ to\ a\ kd-\/tree\ node}}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \textcolor{keyword}{class\ }DLL\_API\ \mbox{\hyperlink{class_a_n_nkd__tree}{ANNkd\_tree}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_a_n_npoint_set}{ANNpointSet}}\ \{}
\DoxyCodeLine{00706\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00707\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dim;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension\ of\ space}}
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n\_pts;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points\ in\ tree}}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ bkt\_size;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bucket\ size}}
\DoxyCodeLine{00710\ \ \ \ \ ANNpointArray\ \ \ pts;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ points}}
\DoxyCodeLine{00711\ \ \ \ \ ANNidxArray\ \ \ \ \ pidx;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ indices\ (to\ pts\ array)}}
\DoxyCodeLine{00712\ \ \ \ \ \mbox{\hyperlink{class_a_n_nkd__node}{ANNkd\_ptr}}\ \ \ \ \ \ root;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ root\ of\ kd-\/tree}}
\DoxyCodeLine{00713\ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ bnd\_box\_lo;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bounding\ box\ low\ point}}
\DoxyCodeLine{00714\ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ bnd\_box\_hi;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bounding\ box\ high\ point}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \ \ \textcolor{keywordtype}{void}\ SkeletonTree(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ construct\ skeleton\ tree}}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ bs,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bucket\ size}}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ ANNpointArray\ pa\ =\ NULL,\ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ array\ (optional)}}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ ANNidxArray\ pi\ =\ NULL);\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ indices\ (optional)}}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00724\ \ \ \ \ \mbox{\hyperlink{class_a_n_nkd__tree}{ANNkd\_tree}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ skeleton\ tree}}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n\ =\ 0,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dd\ =\ 0,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ bs\ =\ 1);\ \ \ \ \ \ \ \ \textcolor{comment}{//\ bucket\ size}}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \ \ \mbox{\hyperlink{class_a_n_nkd__tree}{ANNkd\_tree}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ from\ point\ array}}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ ANNpointArray\ \ \ pa,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ array}}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ bs\ =\ 1,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bucket\ size}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ ANNsplitRule\ \ \ \ split\ =\ ANN\_KD\_SUGGEST);\ \ \ \ \textcolor{comment}{//\ splitting\ method}}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \ \ \ \ \mbox{\hyperlink{class_a_n_nkd__tree}{ANNkd\_tree}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ from\ dump\ file}}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ std::istream\&\ \ \ in);\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ input\ stream\ for\ dump\ file}}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \ \ \ \ \mbox{\hyperlink{class_a_n_nkd__tree}{\string~ANNkd\_tree}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ tree\ destructor}}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{keywordtype}{void}\ annkSearch(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ approx\ k\ near\ neighbor\ search}}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ query\ point}}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ near\ neighbors\ to\ return}}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0);\ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \ \ \textcolor{keywordtype}{void}\ annkPriSearch(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ priority\ k\ near\ neighbor\ search}}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ query\ point}}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ near\ neighbors\ to\ return}}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0);\ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ \ \ \textcolor{keywordtype}{int}\ annkFRSearch(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ approx\ fixed-\/radius\ kNN\ search}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ ANNpoint\ \ \ \ \ \ \ \ q,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ query\ point}}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ ANNdist\ \ \ \ \ \ \ \ \ sqRad,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ squared\ radius\ of\ query\ ball}}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ k,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ neighbors\ to\ return}}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ ANNidxArray\ \ \ \ \ nn\_idx\ =\ NULL,\ \ \textcolor{comment}{//\ nearest\ neighbor\ array\ (modified)}}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ ANNdistArray\ \ \ \ dd\ =\ NULL,\ \ \ \ \ \ \textcolor{comment}{//\ dist\ to\ near\ neighbors\ (modified)}}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ \ \ \ \ \ \ \ \ \ eps=0.0);\ \ \ \ \ \ \ \textcolor{comment}{//\ error\ bound}}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \ \ \ \ \textcolor{keywordtype}{int}\ theDim()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ dimension\ of\ space}}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ dim;\ \}}
\DoxyCodeLine{00765\ }
\DoxyCodeLine{00766\ \ \ \ \ \textcolor{keywordtype}{int}\ nPoints()\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ number\ of\ points}}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ n\_pts;\ \}}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \ \ ANNpointArray\ thePoints()\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ pointer\ to\ points}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \{\ \ \textcolor{keywordflow}{return}\ pts;\ \ \}}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ Print(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ print\ the\ tree\ (for\ debugging)}}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ ANNbool\ \ \ \ \ \ \ \ \ with\_pts,\ \ \ \ \ \ \ \textcolor{comment}{//\ print\ points\ as\ well?}}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ std::ostream\&\ \ \ out);\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ output\ stream}}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ Dump(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dump\ entire\ tree}}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ ANNbool\ \ \ \ \ \ \ \ \ with\_pts,\ \ \ \ \ \ \ \textcolor{comment}{//\ print\ points\ as\ well?}}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ std::ostream\&\ \ \ out);\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ output\ stream}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ getStats(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ tree\ statistics}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_a_n_nkd_stats}{ANNkdStats}}\&\ \ \ \ \ \ \ st);\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ statistics\ (modified)}}
\DoxyCodeLine{00782\ \};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00785\ \textcolor{comment}{//\ \ Box\ decomposition\ tree\ (bd-\/tree)}}
\DoxyCodeLine{00786\ \textcolor{comment}{//\ \ \ \ \ \ The\ bd-\/tree\ is\ inherited\ from\ a\ kd-\/tree.\ \ The\ main\ difference}}
\DoxyCodeLine{00787\ \textcolor{comment}{//\ \ \ \ \ \ in\ the\ bd-\/tree\ and\ the\ kd-\/tree\ is\ a\ new\ type\ of\ internal\ node}}
\DoxyCodeLine{00788\ \textcolor{comment}{//\ \ \ \ \ \ called\ a\ shrinking\ node\ (in\ the\ kd-\/tree\ there\ is\ only\ one\ type}}
\DoxyCodeLine{00789\ \textcolor{comment}{//\ \ \ \ \ \ of\ internal\ node,\ a\ splitting\ node).\ \ The\ shrinking\ node}}
\DoxyCodeLine{00790\ \textcolor{comment}{//\ \ \ \ \ \ makes\ it\ possible\ to\ generate\ balanced\ trees\ in\ which\ the}}
\DoxyCodeLine{00791\ \textcolor{comment}{//\ \ \ \ \ \ cells\ have\ bounded\ aspect\ ratio,\ by\ allowing\ the\ decomposition}}
\DoxyCodeLine{00792\ \textcolor{comment}{//\ \ \ \ \ \ to\ zoom\ in\ on\ regions\ of\ dense\ point\ concentration.\ \ Although}}
\DoxyCodeLine{00793\ \textcolor{comment}{//\ \ \ \ \ \ this\ is\ a\ nice\ idea\ in\ theory,\ few\ point\ distributions\ are\ so}}
\DoxyCodeLine{00794\ \textcolor{comment}{//\ \ \ \ \ \ densely\ clustered\ that\ this\ is\ really\ needed.}}
\DoxyCodeLine{00795\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \textcolor{keyword}{class\ }DLL\_API\ \mbox{\hyperlink{class_a_n_nbd__tree}{ANNbd\_tree}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_a_n_nkd__tree}{ANNkd\_tree}}\ \{}
\DoxyCodeLine{00798\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00799\ \ \ \ \ \mbox{\hyperlink{class_a_n_nbd__tree}{ANNbd\_tree}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ skeleton\ tree}}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ bs\ =\ 1)\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bucket\ size}}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_a_n_nkd__tree}{ANNkd\_tree}}(n,\ dd,\ bs)\ \{\}\ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ base\ kd-\/tree}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \ \ \ \ \mbox{\hyperlink{class_a_n_nbd__tree}{ANNbd\_tree}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ from\ point\ array}}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ ANNpointArray\ \ \ pa,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ point\ array}}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ points}}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ dd,\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ dimension}}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ bs\ =\ 1,\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ bucket\ size}}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ ANNsplitRule\ \ \ \ split\ \ =\ ANN\_KD\_SUGGEST,\ \ \ \ \textcolor{comment}{//\ splitting\ rule}}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ ANNshrinkRule\ \ \ shrink\ =\ ANN\_BD\_SUGGEST);\ \ \ \textcolor{comment}{//\ shrinking\ rule}}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \ \ \ \ \mbox{\hyperlink{class_a_n_nbd__tree}{ANNbd\_tree}}(\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ from\ dump\ file}}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ std::istream\&\ \ \ in);\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ input\ stream\ for\ dump\ file}}
\DoxyCodeLine{00815\ \};}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00818\ \textcolor{comment}{//\ \ Other\ functions}}
\DoxyCodeLine{00819\ \textcolor{comment}{//\ \ annMaxPtsVisit\ \ \ \ \ \ Sets\ a\ limit\ on\ the\ maximum\ number\ of\ points}}
\DoxyCodeLine{00820\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ to\ visit\ in\ the\ search.}}
\DoxyCodeLine{00821\ \textcolor{comment}{//\ \ annClose\ \ \ \ \ \ \ \ \ \ \ \ Can\ be\ called\ when\ all\ use\ of\ ANN\ is\ finished.}}
\DoxyCodeLine{00822\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ It\ clears\ up\ a\ minor\ memory\ leak.}}
\DoxyCodeLine{00823\ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ DLL\_API\ \textcolor{keywordtype}{void}\ annMaxPtsVisit(\ \ \ \ \textcolor{comment}{//\ max.\ pts\ to\ visit\ in\ search}}
\DoxyCodeLine{00826\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ maxPts);\ \ \ \ \textcolor{comment}{//\ the\ limit}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ DLL\_API\ \textcolor{keywordtype}{void}\ annClose();\ \ \ \ \ \ \ \ \textcolor{comment}{//\ called\ to\ end\ use\ of\ ANN}}
\DoxyCodeLine{00829\ }
\DoxyCodeLine{00830\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
